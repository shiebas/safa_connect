{% extends "admin/base_site.html" %}
{% load i18n %}

{% block content %}
<div id="content-main">
    <h1>{{ title }}</h1>
    
    <div class="module">
        <div style="text-align: center; margin-bottom: 20px; padding: 20px; background-color: #f8f9fa;">
            <h2>Overall Coverage</h2>
            <div style="font-size: 36px; font-weight: bold;">
                {{ overall.coverage|floatformat:1 }}%
            </div>
            <p>
                {% if overall.missing == 0 %}
                    All entities have SAFA IDs
                {% else %}
                    {{ overall.missing }} entities still need SAFA IDs
                {% endif %}
            </p>
            <a href="/admin/tools/generate-all-safa-ids/" class="button" 
               style="padding: 10px 15px; background-color: #79aec8; color: white; text-decoration: none;">
                Generate Missing IDs
            </a>
        </div>
        
        <table>
            <thead>
                <tr>
                    <th>Entity Type</th>
                    <th>Total</th>
                    <th>With SAFA ID</th>
                    <th>Missing</th>
                    <th>Coverage</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for item in stats %}
                <tr>
                    <td>{{ item.name }}</td>
                    <td>{{ item.total }}</td>
                    <td>{{ item.total|add:"-"|add:item.missing }}</td>
                    <td>{{ item.missing }}</td>
                    <td>
                        <div style="width:100%; background-color:#f3f3f3; border-radius:5px;">
                            <div style="width:{{ item.coverage }}%; background-color:{% if item.coverage == 100 %}#2ecc71{% elif item.coverage >= 80 %}#f39c12{% else %}#e74c3c{% endif %}; height:10px; border-radius:5px;"></div>
                        </div>
                        {{ item.coverage|floatformat:1 }}%
                    </td>
                    <td>
                        {% if item.missing > 0 %}
                            <a href="{{ item.url }}" class="button">View Missing</a>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
