{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}
{% block title %}Register - SAFA ADMINISTRATION{% endblock %}

{% block content %}
<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-md-10 col-lg-8">
      <div class="card" style="border: 2px solid var(--safa-black);">
        <div class="card-header text-center">
          <h2 class="mb-0">Register with SAFA</h2>
          <p class="text-muted">Register players, administrators, and club officials</p>
        </div>
        <div class="card-body">
          {% if messages %}
            {% for message in messages %}
              <div class="alert alert-{{ message.tags }}">{{ message }}</div>
            {% endfor %}
          {% endif %}

          <form id="registration-form" 
                method="post" 
                enctype="multipart/form-data" 
                novalidate
                data-id-number-id="id_id_number"
                data-country-id="id_country" 
                data-dob-id="id_date_of_birth"
                data-gender-id="id_gender"
                data-id-doc-type-id="id_id_document_type">
            {% csrf_token %}
            {% crispy form %}
            
            <div class="d-grid gap-2 mt-4">
              <button type="submit" class="btn btn-dark">Register</button>
            </div>
          </form>

        </div> <!-- card-body -->
      </div> <!-- card -->
    </div> <!-- col -->
  </div> <!-- row -->
</div> <!-- container -->
{% endblock %}

{% block extra_js %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="{% static 'js/registration.js' %}"></script>
<script>
  $(document).ready(function() {
    // Show/hide province field based on selected role
    $('#id_role').change(function() {
        if ($(this).val() === 'ADMIN_PROVINCE') {
            // Target the field's parent div with the proper ID or class
            // This depends on how you configured your layout in forms.py
            $('.province-field-wrapper').show();
        } else {
            $('.province-field-wrapper').hide();
        }
    });
    
    // Trigger change on page load
    $('#id_role').trigger('change');
  });
</script>
{% endblock %}

<style>
  .admin-field-wrapper {
    padding: 10px;
    margin: 10px 0;
    background-color: #f8f9fa;
    border-left: 3px solid #343a40;
  }
  .province-field-wrapper { border-left-color: #007bff; }
  .region-field-wrapper { border-left-color: #28a745; }
  .lfa-field-wrapper { border-left-color: #ffc107; }
  .club-field-wrapper { border-left-color: #dc3545; }
</style>
